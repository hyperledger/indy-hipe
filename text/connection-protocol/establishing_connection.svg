<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1247px" preserveAspectRatio="none" style="width:579px;height:1247px;" version="1.1" viewBox="0 0 579 1247" width="579px" zoomAndPan="magnify"><defs><filter height="300%" id="fn9rtiapvlv6w" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="130" x2="130" y1="86.4883" y2="1159.7734"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="445.5" x2="445.5" y1="86.4883" y2="1159.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="111" y="83.5352">Alice</text><ellipse cx="130.5" cy="13" fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M130.5,21 L130.5,48 M117.5,29 L143.5,29 M130.5,48 L117.5,63 M130.5,48 L143.5,63 " fill="none" filter="url(#fn9rtiapvlv6w)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="111" y="1172.3086">Alice</text><ellipse cx="130.5" cy="1185.2617" fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M130.5,1193.2617 L130.5,1220.2617 M117.5,1201.2617 L143.5,1201.2617 M130.5,1220.2617 L117.5,1235.2617 M130.5,1220.2617 L143.5,1235.2617 " fill="none" filter="url(#fn9rtiapvlv6w)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="26" x="429.5" y="83.5352">Bob</text><ellipse cx="445.5" cy="13" fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M445.5,21 L445.5,48 M432.5,29 L458.5,29 M445.5,48 L432.5,63 M445.5,48 L458.5,63 " fill="none" filter="url(#fn9rtiapvlv6w)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="26" x="429.5" y="1172.3086">Bob</text><ellipse cx="445.5" cy="1185.2617" fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M445.5,1193.2617 L445.5,1220.2617 M432.5,1201.2617 L458.5,1201.2617 M445.5,1220.2617 L432.5,1235.2617 M445.5,1220.2617 L458.5,1235.2617 " fill="none" filter="url(#fn9rtiapvlv6w)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" height="191" style="stroke: #A80036; stroke-width: 1.0;" width="203" x="29" y="101.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="33" y="118.0566">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="49" y="133.3672">"id": offer_nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="49" y="148.6777">"type": connection_offer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="49" y="163.9883">"content": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="65" y="179.2988">"endpoint": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="81" y="194.6094">"did": A.endpoint.did</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="85" y="209.9199">— or —</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="81" y="225.2305">"uri": A.endpoint.uri</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="81" y="240.541">"verkey": A.endpoint.vk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="65" y="255.8516">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="49" y="271.1621">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="33" y="286.4727">}</text><polygon fill="#A80036" points="433.5,330.8359,443.5,334.8359,433.5,338.8359,437.5,334.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="130.5" x2="439.5" y1="334.8359" y2="334.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="12" x="137.5" y="314.7832">1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="153.5" y="314.7832">A makes a</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="222.5" y="314.7832">Connection Offer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="337.5" y="314.7832">, in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="137.5" y="330.0938">person or securely over internet</text><rect fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" height="145" style="stroke: #A80036; stroke-width: 1.0;" width="193" x="349" y="382.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="353" y="399.4043">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="369" y="414.7148">"id": offer_nonce (optional)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="369" y="430.0254">"type": connection_request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="369" y="445.3359">"content": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="385" y="460.6465">"did": B.did@B:A</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="385" y="475.957">"verkey": B.vk@B:A</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="385" y="491.2676">"endpoint": B.endpoint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="369" y="506.5781">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="353" y="521.8887">}</text><polygon fill="#A80036" points="141.5,550.9414,131.5,554.9414,141.5,558.9414,137.5,554.9414" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="135.5" x2="444.5" y1="554.9414" y2="554.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="12" x="147.5" y="550.1992">2.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="163.5" y="550.1992">B sends</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="215.5" y="550.1992">Connection Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="354.5" y="550.1992">message</text><rect fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" height="130" style="stroke: #A80036; stroke-width: 1.0;" width="207" x="27" y="602.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="31" y="619.5098">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="47" y="634.8203">"to": A.did@B:A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="47" y="650.1309">"type": connection_response,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="47" y="665.4414">"content": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="79" y="680.752">"did": A.did@A:B,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="79" y="696.0625">"verkey": A.vk@A:B</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="47" y="711.373">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="31" y="726.6836">}</text><polygon fill="#A80036" points="433.5,755.7363,443.5,759.7363,433.5,763.7363,437.5,759.7363" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="130.5" x2="439.5" y1="759.7363" y2="759.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="12" x="137.5" y="754.9941">3.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="153.5" y="754.9941">A sends</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145" x="207.5" y="754.9941">Connection Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="356.5" y="754.9941">message</text><rect fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" height="84" style="stroke: #A80036; stroke-width: 1.0;" width="245" x="323" y="807.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="327" y="824.3047">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="343" y="839.6152">"to": A.did@A:B</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="343" y="854.9258">"type": message_acknowledgement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="343" y="870.2363">"message": "success"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="327" y="885.5469">}</text><polygon fill="#A80036" points="141.5,914.5996,131.5,918.5996,141.5,922.5996,137.5,918.5996" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="135.5" x2="444.5" y1="918.5996" y2="918.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="12" x="147.5" y="913.8574">4.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="163.5" y="913.8574">B sends</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="215.5" y="913.8574">Connection Acknowledgement</text><rect fill="#FFFFFF" filter="url(#fn9rtiapvlv6w)" height="84" style="stroke: #A80036; stroke-width: 1.0;" width="245" x="8" y="966.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="12" y="983.168">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="28" y="998.4785">"id": B.did@B:A</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="28" y="1013.7891">"type": message_acknowledgement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="28" y="1029.0996">"message": "success"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="12" y="1044.4102">}</text><polygon fill="#A80036" points="433.5,1073.4629,443.5,1077.4629,433.5,1081.4629,437.5,1077.4629" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="130.5" x2="439.5" y1="1077.4629" y2="1077.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="12" x="137.5" y="1072.7207">5.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="153.5" y="1072.7207">A sends</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="207.5" y="1072.7207">Connection Acknowledgement</text><polygon fill="#A80036" points="141.5,1137.7734,131.5,1141.7734,141.5,1145.7734,137.5,1141.7734" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="433.5,1137.7734,443.5,1141.7734,433.5,1145.7734,437.5,1141.7734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="135.5" x2="439.5" y1="1141.7734" y2="1141.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="291" x="147.5" y="1137.0313">A &amp; B can now send auth-encrypted messages</text><!--
@startuml

actor Alice as A #white
actor Bob as B #white


rnote over A #white
{
    "id": offer_nonce
    "type": connection_offer
    "content": {
        "endpoint": {
            "did": A.endpoint.did
             — or —
            "uri": A.endpoint.uri
            "verkey": A.endpoint.vk
        }
    }
}
end note

A -> B: **1.** A makes a **Connection Offer**, in\nperson or securely over internet
||35||


rnote over B #white
{
    "id": offer_nonce (optional)
    "type": connection_request
    "content": {
        "did": B.did@B:A
        "verkey": B.vk@B:A
        "endpoint": B.endpoint
    }
}
end note

B -> A: **2.** B sends **Connection Request** message
||35||


rnote over A #white
{
    "to": A.did@B:A,
    "type": connection_response,
    "content": {
            "did": A.did@A:B,
            "verkey": A.vk@A:B
    }
}
end note

A -> B: **3.** A sends **Connection Response** message
||35||


rnote over B #white
{
    "to": A.did@A:B
    "type": message_acknowledgement
    "message": "success"
}
end note

B -> A: **4.** B sends **Connection Acknowledgement** 
||35||


rnote over A #white
{
    "id": B.did@B:A
    "type": message_acknowledgement
    "message": "success"
}
end note

A -> B: **5.** A sends **Connection Acknowledgement** 
||35||


A <-> B: A & B can now send auth-encrypted messages

@enduml

PlantUML version 1.2018.03(Thu Apr 05 10:59:15 MDT 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 9.0.1+11
Operating System: Mac OS X
OS Version: 10.13.5
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>